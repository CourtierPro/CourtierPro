@startuml
title CourtierPro - Deployment Diagram (DigitalOcean)

left to right direction
skinparam nodeStyle rectangle

' ==========================
' User Side
' ==========================
node "User Device\n[Windows / macOS / Mobile]" as Device {
  node "Web Browser\n[Container: React SPA]\nProvides CourtierPro UI" as Browser
}

' ==========================
' Cloud / Production
' ==========================
node "DigitalOcean Droplet\n[OS: Ubuntu Linux]" as DO_VM {
  
  node "Docker Engine" as Docker {
    
    node "Cloudflare Tunnel\n[Container: cloudflared]\nSecure entry point (Ingress)" as Tunnel
    
    node "CourtierPro Frontend\n[Container: Nginx/Static]\nServes SPA assets" as Frontend
    
    node "CourtierPro Backend\n[Container: Spring Boot]\nREST API & Business Logic" as Backend
    
    database "PostgreSQL Database\n[Container: PostgreSQL 15]\nPersistent Data" as DB
  }
}

' ==========================
' External Services
' ==========================
node "External Services" as Ext {
  node "Auth0\n(Identity & Auth)" as Auth0
  node "Amazon S3\n(Document Storage)" as S3
  node "Amazon SES\n(Email)" as SES
}

' ==========================
' Connections
' ==========================
' Ingress
Browser --> Tunnel : HTTPS (via Cloudflare Edge)
Tunnel --> Frontend : Proxies requests
Tunnel --> Backend : Proxies /api requests

' Internal
Backend --> DB : JDBC/R2DBC (Internal Docker Network)

' External
Browser --> Auth0 : Redirects for Login
Backend --> Auth0 : Validates Tokens (OIDC)
Backend --> S3 : Stores Documents
Backend --> SES : Sends Emails

@enduml
