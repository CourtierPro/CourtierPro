@startuml Relationships
skinparam classAttributeIconSize 0
skinparam linetype ortho
hide members

title Design Level Class Diagram: Relationships Overview

package "Presentation Layer" #LightBlue {
  class DocumentController
  class GlobalDocumentController
  class DocumentRequestDTO
  class DocumentResponseDTO
  class DocumentReviewRequestDTO
  class DocumentVersionDTO
}

package "Business Layer" #LightGreen {
  interface DocumentService
  class DocumentServiceImpl
  interface NotificationService
}

package "Data Layer" #LightYellow {
  interface DocumentRepository
  interface TransactionRepository
  class Document <<Entity>>
  class DocumentVersion <<Entity>>
  class TransactionRef <<Value Object>>
  class StorageObject <<Value Object>>
  class UploadedBy <<Value Object>>
}

package "Infrastructure Layer" #LightCoral {
  interface S3StorageService
  class S3StorageServiceImpl
}

package "Enums" #LightGray {
  enum DocumentTypeEnum
  enum DocumentStatusEnum
  enum DocumentPartyEnum
}

' ==========================================
' PRESENTATION LAYER - Internal
' ==========================================
' ==========================================
' PRESENTATION LAYER - Internal
' ==========================================
DocumentController ..> DocumentRequestDTO : receives
DocumentController ..> DocumentResponseDTO : returns
DocumentController ..> DocumentReviewRequestDTO : receives
DocumentResponseDTO ..> DocumentVersionDTO : contains

' ==========================================
' BUSINESS LAYER - Internal
' ==========================================
DocumentServiceImpl ..|> DocumentService : implements

' ==========================================
' DATA LAYER - Internal
' ==========================================
' ==========================================
' DATA LAYER - Internal
' ==========================================
DocumentRepository ..> Document : persists
Document "1" *-- "1" TransactionRef : contains
Document "1" *-- "0..*" DocumentVersion : contains
DocumentVersion "1" *-- "1" StorageObject : contains
DocumentVersion "1" *-- "1" UploadedBy : contains

' ==========================================
' INFRASTRUCTURE LAYER - Internal
' ==========================================
S3StorageServiceImpl ..|> S3StorageService : implements

' ==========================================
' CROSS-PACKAGE: Presentation → Business
' ==========================================
DocumentController --> DocumentService : uses
GlobalDocumentController --> DocumentService : uses

' ==========================================
' CROSS-PACKAGE: Business → Data
' ==========================================
DocumentServiceImpl --> DocumentRepository : uses
DocumentServiceImpl --> TransactionRepository : uses
DocumentServiceImpl ..> Document : manages

' ==========================================
' CROSS-PACKAGE: Business → Infrastructure
' ==========================================
DocumentServiceImpl --> S3StorageService : uses

' ==========================================
' CROSS-PACKAGE: Business → Business
' ==========================================
DocumentServiceImpl --> NotificationService : uses

' ==========================================
' CROSS-PACKAGE: Business → Presentation
' ==========================================
DocumentServiceImpl ..> DocumentResponseDTO : creates

' ==========================================
' CROSS-PACKAGE: Data → Enums
' ==========================================
Document --> DocumentTypeEnum
Document --> DocumentStatusEnum
Document --> DocumentPartyEnum

@enduml
